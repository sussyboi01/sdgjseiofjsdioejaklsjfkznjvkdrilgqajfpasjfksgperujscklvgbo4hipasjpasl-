      - name: Process JSON and Move Files (Move Only Newer Files)
        run: |
          node << 'EOF'
          const fs = require("fs");
          const path = require("path");
          const { execSync } = require("child_process");

          const repoRoot = process.cwd();
          const jsonPath = path.join(repoRoot, "similar-names.json");
          const backupBaseDir = path.join(repoRoot, "_duplicates_backup");

          if (!fs.existsSync(jsonPath)) {
            console.log("No JSON found. Exiting.");
            process.exit(0);
          }

          const groups = JSON.parse(fs.readFileSync(jsonPath, "utf8"));
          let movedCount = 0;

          if (!fs.existsSync(backupBaseDir)) {
            fs.mkdirSync(backupBaseDir);
          }

          console.log("Processing groups from JSON...\n");

          function getGitCreatedAt(relPath) {
            try {
              const cmd = `git log --diff-filter=A --follow --format=%aI -- "${relPath}" | tail -1`;
              const out = execSync(cmd).toString().trim();
              return out ? new Date(out) : null;
            } catch {
              return null;
            }
          }

          groups.forEach(group => {
            const fileData = group.map(relPath => {
              const absolutePath = path.join(repoRoot, relPath);
              if (!fs.existsSync(absolutePath)) return null;

              const createdAt = getGitCreatedAt(relPath);

              return {
                rel: relPath,
                abs: absolutePath,
                createdAt: createdAt || new Date(0) // fallback: treat missing timestamps as oldest
              };
            }).filter(v => v);

            if (fileData.length < 2) return;

            // Sort by creation time (oldest first)
            fileData.sort((a, b) => a.createdAt - b.createdAt);

            const oldest = fileData[0]; // KEEP
            const newerOnes = fileData.slice(1); // MOVE

            console.log(`Group found: ${group.join(", ")}`);
            console.log(`Keeping OLDEST: ${oldest.rel} (${oldest.createdAt})`);

            newerOnes.forEach(file => {
              const destPath = path.join(backupBaseDir, file.rel);
              const destDir = path.dirname(destPath);

              if (!fs.existsSync(destDir)) fs.mkdirSync(destDir, { recursive: true });

              try {
                console.log(`  MOVING newer file: ${file.rel}`);
                console.log(`    Created at: ${file.createdAt}`);
                console.log(`    Reason: Newer than ${oldest.rel}`);

                fs.renameSync(file.abs, destPath);
                movedCount++;
              } catch (err) {
                console.error(`ERROR moving ${file.rel}: ${err.message}`);
              }
            });

            console.log("");
          });

          console.log(`\nDone â€” moved ${movedCount} newer duplicate files.`);
          EOF
